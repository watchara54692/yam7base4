<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twilight Resonance V8 - Golden Foundation</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f1c40f; --bg: #0a0a0c; --card: #15151a; --accent: #ff4757; --glass: rgba(255, 255, 255, 0.05); }
        body { font-family: 'Sarabun', sans-serif; background: var(--bg); color: #ecf0f1; margin: 0; padding: 15px; }
        .app-container { max-width: 500px; margin: auto; background: var(--card); padding: 30px; border-radius: 30px; border: 1px solid #222; box-shadow: 0 25px 50px rgba(0,0,0,0.6); }
        h1 { color: var(--gold); text-align: center; font-size: 1.6rem; letter-spacing: 1px; margin-bottom: 5px; }
        .instruction { text-align: center; font-size: 0.8rem; opacity: 0.6; margin-bottom: 25px; }
        .input-box { background: var(--glass); padding: 20px; border-radius: 20px; border: 1px solid #333; margin-bottom: 20px; }
        label { display: block; font-size: 0.85rem; color: var(--gold); margin-bottom: 8px; font-weight: bold; }
        input, select { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #444; background: #000; color: #fff; font-size: 1rem; box-sizing: border-box; margin-bottom: 15px; }
        button { width: 100%; padding: 18px; background: var(--gold); color: #000; border: none; border-radius: 15px; font-weight: bold; font-size: 1.3rem; cursor: pointer; transition: 0.3s; }
        button:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(241, 196, 15, 0.3); }
        .result-panel { display: none; margin-top: 30px; }
        .star-row { display: flex; justify-content: center; gap: 15px; margin-bottom: 25px; }
        .star { width: 65px; height: 65px; background: #000; color: var(--gold); border: 2px solid var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; font-weight: bold; box-shadow: 0 0 15px rgba(241, 196, 15, 0.2); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: var(--glass); padding: 15px; border-radius: 15px; text-align: center; font-size: 1.5rem; font-weight: bold; color: var(--accent); border: 1px solid #333; }
        .debug-info { font-size: 0.8rem; background: #000; padding: 15px; border-radius: 12px; margin-top: 20px; color: #888; border-left: 4px solid var(--gold); line-height: 1.6; }
    </style>
</head>
<body>

<div class="app-container">
    <h1>Twilight Resonance V8</h1>
    <p class="instruction">ระบบสังเคราะห์เลข 7 ตัว 4 ฐาน (ฉบับวิจัยเจาะลึก)</p>

    <div class="input-box">
        <label>วันที่ออกรางวัล</label>
        <input type="date" id="d_day">
        
        <label>เดือนไทย (มกราคม=2, กุมภาพันธ์=3...)</label>
        <select id="d_month">
            <option value="2">มกราคม (เดือน 2)</option>
            <option value="3">กุมภาพันธ์ (เดือน 3)</option>
            <option value="4">มีนาคม (เดือน 4)</option>
            <option value="5">เมษายน (เดือน 5)</option>
            <option value="6">พฤษภาคม (เดือน 6)</option>
            <option value="7">มิถุนายน (เดือน 7)</option>
            <option value="1">กรกฎาคม-ธันวาคม (1)</option>
        </select>

        <label>ปีนักษัตร (2569=7, 2568=6, 2567=5)</label>
        <input type="number" id="d_year" value="7">
    </div>

    <button onclick="calculateV8()">คำนวณ Resonance</button>

    <div id="results" class="result-panel">
        <div class="star-row" id="coreStars"></div>
        <div class="grid" id="pairs2"></div>
        <div class="grid" style="margin-top:12px;" id="pairs3"></div>
        <div class="debug-info" id="debug"></div>
    </div>
</div>

<script>
    function calculateV8() {
        const dInput = document.getElementById('d_day').value;
        if(!dInput) return;
        const d = new Date(dInput);

        // 1. ตั้งฐาน 1, 2, 3
        let b1 = d.getDay() === 0 ? 7 : d.getDay();
        let b2 = parseInt(document.getElementById('d_month').value);
        let b3 = parseInt(document.getElementById('d_year').value);
        
        // 2. คำนวณฐานที่ 4 (ผลรวม)
        let sum = b1 + b2 + b3;
        let core = new Set();
        let powerNote = "ฐานปกติ";

        // 3. กฎฐานที่ 4 (ตามคำแนะนำล่าสุด)
        if ([13, 14, 16].includes(sum)) {
            // กฎพิเศษ: ยึดเลขในแถวฐาน 3 (ปีนักษัตร) มาพิจารณา
            core.add(b3);
            powerNote = sum === 13 ? "มหาอุด (ยึดเลขฐาน 3)" : 
                        sum === 14 ? "จักรพรรดิ (ยึดเลขฐาน 3)" : 
                        "โสฬสมงคล (ยึดเลขฐาน 3)";
        } 
        else if (sum === 9) { core.add(9); powerNote = "พระเกตุ (9)"; }
        else if (sum === 10 || sum === 20) { core.add(7); core.add(0); powerNote = "กำลังพระเสาร์ (10/20)"; }
        else if (sum === 12) { core.add(8); powerNote = "กำลังพระราหู (12)"; }
        else if (sum === 15) { core.add(2); powerNote = "กำลังพระจันทร์ (15)"; }
        else if (sum === 17) { core.add(4); powerNote = "กำลังพระพุธ (17)"; }
        else if (sum === 19) { core.add(5); powerNote = "กำลังพระพฤหัส (19)"; }
        else if (sum === 21) { core.add(6); powerNote = "กำลังพระศุกร์ (21)"; }
        else { core.add(sum % 7 || 7); }

        // เพิ่มฐานวันและเดือน
        core.add(b1);
        core.add(b2);

        // กฎ Saturn-Zero: ถ้ามี 7 ให้ปรากฏเป็น 0 เสมอตามรายงานวิจัย
        if (core.has(7)) {
            core.add(0);
        }

        // กฎ Shadow: วันเสาร์/อาทิตย์ (6, 7) ให้เพิ่ม 9
        if (b1 >= 6) core.add(9);

        let finalStars = Array.from(core).slice(0, 4);

        // แสดงผล
        document.getElementById('coreStars').innerHTML = finalStars.map(s => `<div class="star">${s}</div>`).join('');
        
        let p2 = [];
        for(let i=0; i<finalStars.length; i++) {
            for(let j=i+1; j<finalStars.length; j++) {
                p2.push(`<div class="card">${finalStars[i]}${finalStars[j]}</div>`);
            }
        }
        document.getElementById('pairs2').innerHTML = p2.slice(0, 4).join('');

        let p3 = [];
        if(finalStars.length >= 3) {
            p3.push(`<div class="card">${finalStars[0]}${finalStars[1]}${finalStars[2]}</div>`);
            p3.push(`<div class="card">${finalStars[1]}${finalStars[2]}${finalStars[3]}</div>`);
        }
        document.getElementById('pairs3').innerHTML = p3.join('');

        document.getElementById('debug').innerHTML = `
            <strong>วิเคราะห์เชิงฐานเลข:</strong><br>
            • ฐาน(1)วัน:${b1} | ฐาน(2)เดือน:${b2} | ฐาน(3)ปี:${b3}<br>
            • ผลรวมฐานที่ 4: ${sum} -> [${powerNote}]<br>
            • เลขที่ใช้พิจารณาจากฐานรองรับ: ${Array.from(core).filter(x => x !== b1 && x !== b2)}
        `;
        document.getElementById('results').style.display = 'block';
    }
</script>

</body>
</html>
